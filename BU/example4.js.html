<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>~/Documents/github/jdog/javascript-SOP/demo1/example4.js.html</title>
<meta name="Generator" content="Vim/7.4">
<meta name="plugin-version" content="vim7.4_v1">
<meta name="syntax" content="javascript">
<meta name="settings" content="use_css,pre_wrap,no_foldcolumn,expand_tabs,prevent_copy=">
<meta name="colorscheme" content="darkblue">
<style type="text/css">
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #c0c0c0; background-color: #000040; }
body { font-family: monospace; color: #c0c0c0; background-color: #000040; }
* { font-size: 1em; }
.Folded { color: #808080; background-color: #000040; padding-bottom: 1px; }
.Type { color: #60ff60; }
.Statement { color: #ffff60; }
.Comment { color: #80a0ff; }
.Constant { color: #ffa0a0; }
.Identifier { color: #40ffff; }
-->
</style>

<script type='text/javascript'>
<!--

-->
</script>
</head>
<body>
<pre id='vimCodeElement'>
<span class="Comment">// First Parameter is the name with namespace</span>
<span class="Comment">// in this example, a Constructor that takes two parameters</span>
<span class="Comment">//</span>
<span class="Comment">// Constructors are a special kind of function</span>
<span class="Comment">// that creates an object that has public methods and properties</span>
<span class="Comment">// this simple example has three public properties</span>
<span class="Comment">// $form, $html, and options</span>
<span class="Comment">//</span>
<span class="Comment">// it also has a public (Module) property, validation</span>
<span class="Comment">//</span>
<span class="Comment">// in addition, because it employs the events extension</span>
<span class="Comment">// the following methods are added as well</span>
<span class="Comment">//</span>
<span class="Comment">// addEvent( String, Function )</span>
<span class="Comment">// triggerEvent ( String, property, property ... )</span>
<span class="Comment">//</span>
<span class="Comment">// as well as this events object</span>
<span class="Comment">// events {</span>
<span class="Comment">//  Success : Array</span>
<span class="Comment">//  , Fail : Array</span>
<span class="Comment">//  , SubmitClick : Array</span>
<span class="Comment">// }</span>

PAGE.add(<span class="Constant">&quot;Constructors.Login&quot;</span>, <span class="Identifier">function</span>($form, options) {

<span class="Comment">  // define options if not defined</span>
  options = options || { }

<span class="Comment">  // options are optional, this line of code falls back to false if property is not defined</span>
  options.showError = options.showError || <span class="Constant">false</span>

<span class="Comment">  // ah, the beloved dog</span>
<span class="Comment">  // a dog is the equivalent to the exports object</span>
<span class="Comment">  // the dog is the thing that gets returned from the contructor</span>
<span class="Comment">  // the dog is defined in this way to create a legend towards</span>
<span class="Comment">  // the top of the file, to allow for quick reference</span>

  <span class="Type">var</span> dog = {
    $form : $form
    , $html : <span class="Type">undefined</span> <span class="Comment">// see below</span>
    , <span class="Statement">options</span> : options
    , <span class="Statement">validation</span> : <span class="Type">undefined</span> <span class="Comment">// see below</span>
  }

<span class="Comment">  // the reference object, AKA ref is an object to house all external libraries</span>
  , ref = dog.ref = { }

<span class="Comment">  // employs the PAGE events extension </span>
<span class="Comment">  // this adds publically available events based on these names</span>
<span class="Comment">  // these events are a series of functions that get fired when the named event is triggered</span>
  PAGE.ext.events(dog, {
    <span class="Statement">Success</span> : []
    , <span class="Statement">Fail</span> : []
    , <span class="Statement">SubmitClick</span> : []
  })

<span class="Comment">  // a very common technique is to generate all of the HTML needed in this file</span>
<span class="Comment">  // having html defined outside of the constructor is also valid, but may lead to greater complexity</span>
<span class="Comment">  // when it comes to file management</span>
<span class="Folded">+--- 18 lines: function build() {----------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span>

<span class="Comment">  // also extremely common practice is to create an events function</span>
<span class="Comment">  // this is a great place to trigger any named events, add click events through jQuery etc</span>
<span class="Comment">  // events should be fired after the HTML has been built</span>
<span class="Comment">  // events should relate directly to the built HTML and not the global HTML on the page</span>
<span class="Comment">  // this greatly increases the speed of building out the HTML</span>
  <span class="Identifier">function</span> events() {

<span class="Comment">    // here is an example of calling a library constructor</span>
<span class="Comment">    // notice that the dog.validation object get built by the Validation Constructor</span>
<span class="Comment">    // also notice that this validation constructor has two function callbacks, success and fail</span>
    dog.validation = ref.Validation(dog.$form, <span class="Identifier">function</span> success(data) {

<span class="Comment">      // this triggers the Success event upon the success callback firing</span>
<span class="Comment">      // notice that it is passing in data from the data object</span>
      dog.triggerEvent(<span class="Constant">&quot;Success&quot;</span>, data.id, data.name)

    }, <span class="Identifier">function</span> fail(msg, err) {

<span class="Comment">      // this triggers the Fail event upon the fail callback firing</span>
<span class="Comment">      // notice that it is passing in msg, and err</span>
      dog.triggerEvent(<span class="Constant">&quot;Fail&quot;</span>, msg, err)
    })

<span class="Comment">    // the following code starts the validation code to run</span>
<span class="Comment">    // this specific code keeps checking until the code is valid showing errors as you type</span>
    dog.$form.click(<span class="Identifier">function</span>() {

<span class="Comment">      // this triggers the SubmitClick event</span>
<span class="Comment">      // notice that it is passing in dog.$form</span>
      dog.triggerEvent(<span class="Constant">&quot;SubmitClick&quot;</span>, dog.$form)

<span class="Comment">      // line that starts the validation, a public method of the validation Module embedded in this constructor</span>
      dog.validation.startValidation()
    })

  }

<span class="Comment">  // init is the code that starts everything running</span>
<span class="Comment">  // in this example, init only fires after all external libraries are loaded</span>
  <span class="Identifier">function</span> init() {
    build()
    events()
  }

  PAGE.wait(
    <span class="Constant">&quot;Modules.dataService.read&quot;</span> <span class="Comment">// example not shown here</span>
    , <span class="Constant">&quot;Constructors.Validation&quot;</span> <span class="Comment">// see above for usage</span>
    , ref <span class="Comment">// passing in the reference object here</span>
    , init) <span class="Comment">// finally firing this function when it's done loading</span>

<span class="Comment">  // finally return the dog</span>
<span class="Comment">  // consider dog like the exports object, or the this object</span>
  <span class="Statement">return</span> dog

})
</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
